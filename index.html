<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FishingTackle.ai - AI Fishing Gear + Tips</title>
    <meta name="description" content="Instant AI-powered tackle recommendations for exactly where, when, and what fish you're chasing.">
    <style>
        :root { --p: #0066cc; --s: #28a745; }
        body { font-family: system-ui, sans-serif; margin:0; background:#f0f8ff; color:#222; line-height:1.6; }
        header { background: linear-gradient(135deg, #0066cc, #004d99); color:white; text-align:center; padding:60px 20px; }
        h1 { margin:0; font-size:2.8em; }
        main { max-width:1200px; margin:20px auto; padding:0 15px; }
        form, #out { background:white; border-radius:16px; padding:30px; box-shadow:0 12px 40px rgba(0,0,0,0.1); }
        label { display:block; margin:20px 0 8px; font-weight:700; font-size:1.1em; }
        input, select { width:100%; padding:14px; border:1px solid #ddd; border-radius:10px; font-size:1.1em; }
        button { margin-top:30px; width:100%; padding:18px; background:var(--s); color:white; border:none; border-radius:10px; font-size:1.3em; font-weight:bold; cursor:pointer; transition:0.3s; }
        button:hover { background:#218838; transform:scale(1.02); }
        #out { display:none; margin-top:40px; opacity:0; transition:opacity 0.6s; }
        #out.visible { opacity:1; }
        .tiers { display:grid; gap:24px; margin-top:30px; }
        @media (min-width:1024px) { .tiers { grid-template-columns: 1fr 1fr 1fr; } }  /* ‚Üê FIX: Forces 3 side-by-side on desktop */
        @media (min-width:640px and max-width:1023px) { .tiers { grid-template-columns: 1fr 1fr; } }  /* 2 on tablet */
        @media (max-width:639px) { .tiers { grid-template-columns: 1fr; } }  /* 1 on mobile */
        .tier { border:2px solid #ddd; border-radius:12px; padding:20px; background:#fafafa; }
        .tier:empty { display:none !important; }  /* hides empty tiers */
        .tier h3 { margin:-20px -20px 20px -20px; padding:12px; text-align:center; color:white; border-radius:10px 10px 0 0; font-size:1.4em; }
        .budget h3 { background:#27ae60; }
        .mid h3 { background:#2980b9; }
        .pro h3 { background:#8e44ad; }
        .item { background:white; padding:16px; margin:14px 0; border-radius:10px; border-left:6px solid var(--p); box-shadow:0 3px 10px rgba(0,0,0,0.08); transition:0.2s; }
        .item:hover { transform:translateY(-2px); box-shadow:0 6px 16px rgba(0,0,0,0.12); }
        .links { margin-top:12px; font-size:0.95em; }
        .links a { margin-right:16px; color:var(--p); font-weight:600; text-decoration:none; }
        .links a:hover { text-decoration:underline; }
        .disc { text-align:center; font-size:0.85em; color:#666; margin:60px 0 20px; }
        .load { text-align:center; padding:60px; font-size:1.3em; color:#555; }
        .optional { color:#666; font-weight:normal; font-size:0.95em; }
    </style>
</head>
<body>
<header>
    <h1>FishingTackle.ai</h1>
    <p>Tell me where you're fishing ‚Üí get exact gear + pro tips that are working right now</p>
</header>
<main>
<form id="f">
    <label>Location (e.g. Destin FL, Lake Lanier, Cape Cod)</label>
    <input type="text" id="loc" required placeholder="City + state or specific spot">
    <label>Date (optional ‚Äì improves seasonal accuracy)</label>
    <input type="date" id="date">
    <label>Target Species <span class="optional">(optional ‚Äì makes recommendations even better)</span></label>
    <input type="text" id="species" placeholder="e.g. Redfish, Largemouth Bass, Striped Bass, Rainbow Trout, Snook">
    <label>Body of Water</label>
    <select id="body" required>
        <option value="">Choose...</option>
        <option>Saltwater / Ocean</option>
        <option>Inshore / Bay / Flats</option>
        <option>Lake</option>
        <option>River / Stream</option>
        <option>Surf / Beach</option>
    </select>
    <label>Fishing Style</label>
    <select id="type" required>
        <option value="">Choose...</option>
        <option>Surf Casting</option>
        <option>Inshore / Flats</option>
        <option>Offshore / Deep Sea</option>
        <option>Bass Fishing</option>
        <option>Trout / Stream</option>
        <option>Fly Fishing</option>
        <option>Ice Fishing</option>
        <option>Kayak / Wade</option>
    </select>
    <button type="submit">Get My Tackle List ‚Üí</button>
</form>
<div id="out">
    <div class="load" id="load">Asking the fish gods‚Ä¶ üé£</div>
    <div id="tiers-sec" style="display:none">
        <h2 style="text-align:center; margin-bottom:10px;">Your Personalized Tackle Recommendations</h2>
        <div class="tiers">
            <div class="tier budget"><h3>Budget Picks</h3><div id="budget"></div></div>
            <div class="tier mid"><h3>Mid-Range</h3><div id="mid"></div></div>
            <div class="tier pro"><h3>Pro / Premium</h3><div id="pro"></div></div>
        </div>
    </div>
    <div id="tips-sec" style="display:none; margin-top:60px;">
        <h2 style="text-align:center;">Pro Tips & What‚Äôs Biting Right Now</h2>
        <div id="tips"></div>
    </div>
</div>
<p class="disc">Disclosure: We may earn commission on purchases (keeps the site free).</p>
</main>
<script type="module">
    const f = document.getElementById('f');
    const out = document.getElementById('out');
    const load = document.getElementById('load');
    const tiersSec = document.getElementById('tiers-sec');
    const tipsSec = document.getElementById('tips-sec');
    const budgetDiv = document.getElementById('budget');
    const midDiv = document.getElementById('mid');
    const proDiv = document.getElementById('pro');
    const tipsDiv = document.getElementById('tips');

    f.addEventListener('submit', async e => {
        e.preventDefault();
        out.style.display = 'block';
        out.classList.remove('visible');
        tiersSec.style.display = tipsSec.style.display = 'none';
        load.style.display = 'block';
        budgetDiv.innerHTML = midDiv.innerHTML = proDiv.innerHTML = tipsDiv.innerHTML = '';

        const loc = document.getElementById('loc').value.trim();
        const date = document.getElementById('date').value || 'current season';
        const species = document.getElementById('species').value.trim();
        const body = document.getElementById('body').value;
        const type = document.getElementById('type').value;

        const speciesPart = species ? `Target species: ${species}\n` : '';

        const prompt = `You are the #1 fishing tackle expert in 2025.
${speciesPart}Location: ${loc}
Date/Season: ${date}
Water: ${body}
Style: ${type}

Return EXACTLY this format ‚Äî no extra text:

BUDGET:
1. Rod ‚Üí ...
2. Reel ‚Üí ...
... (8 lines total, under $150 total where possible)

MID-RANGE:
1. Rod ‚Üí ...
2. Reel ‚Üí ...
... (8 lines, $200‚Äì450 total)

PRO:
1. Rod ‚Üí ...
2. Reel ‚Üí ...
... (8 lines, premium brands)

TIPS:
1. ...
2. ...

Vary brands across tiers. Only real 4.5+ star 2025 best-sellers widely available on Amazon and FishUSA.`;

        try {
            const r = await fetch('/api/recommend', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ prompt })
            });
            if (!r.ok) throw new Error();
            const d = await r.json();
            const txt = d.choices[0].message.content;

            const parseTier = (tierName, div) => {
                const section = txt.split(tierName + ':')[1]?.split(/\n(?:BUDGET|MID-RANGE|PRO|TIPS):/)[0] || '';
                section.trim().split('\n').filter(l => l.match(/^\d+/)).forEach(l => {
                    const clean = l.replace(/^\d+\.\s*/, '').split('‚Üí')[1]?.trim() || l;
                    const item = document.createElement('div'); item.className = 'item';
                    item.innerHTML = `<strong>${l.replace(/^\d+\.\s*/, '')}</strong><div class="links">
                        <a href="https://amazon.com/s?k=${encodeURIComponent(clean)}&tag=fishingtac0b6-20" target="_blank">Amazon</a>
                        <a href="https://www.fishusa.com/search/?q=${encodeURIComponent(clean)}" target="_blank">FishUSA</a>
                    </div>`;
                    div.appendChild(item);
                });
            };

            parseTier('BUDGET', budgetDiv);
            parseTier('MID-RANGE', midDiv);
            parseTier('PRO', proDiv);

            const tipsPart = txt.split('TIPS:')[1] || '';
            tipsPart.trim().split('\n').filter(l => l.match(/^\d+/)).forEach(l => {
                const item = document.createElement('div'); item.className = 'item';
                item.innerHTML = l.trim();
                tipsDiv.appendChild(item);
            });

            load.style.display = 'none';
            tiersSec.style.display = 'block';
            tipsSec.style.display = 'block';
            setTimeout(() => out.classList.add('visible'), 100);
        } catch {
            load.innerHTML = 'Error ‚Äî try again in a moment.';
        }
    });
</script>
</body>
</html>
